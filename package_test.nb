(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      8011,        232]
NotebookOptionsPosition[      6513,        202]
NotebookOutlinePosition[      6876,        218]
CellTagsIndexPosition[      6833,        215]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", " ", "@", " ", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.755472155234097*^9, 
  3.7554721601537933`*^9}},ExpressionUUID->"85fd61b8-b777-4765-822e-\
c28cb3e65ef0"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuEST`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.7555888303596163`*^9, 
  3.7555888347286158`*^9}},ExpressionUUID->"31e4471c-1aaf-492b-8916-\
245882351583"],

Cell[BoxData[
 RowBox[{
  RowBox[{"env", " ", "=", " ", 
   RowBox[{"CreateRemoteQuESTEnv", "[", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7555888375343943`*^9, 3.755588855946558*^9}, 
   3.755589120517859*^9},ExpressionUUID->"950d8e49-2232-43fa-ae46-\
0b0e5703508e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Psi]", " ", "=", " ", 
   RowBox[{"CreateQureg", "[", "25", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]", " ", "=", " ", 
   RowBox[{"CreateQureg", "[", "25", "]"}]}], ";"}]}], "Input",ExpressionUUID-\
>"95520a55-bd31-491a-b6f4-f46aac7e5655"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"InitPlusState", "[", "\[Psi]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InitPlusState", "[", "\[Phi]", "]"}], ";"}]}], "Input",ExpressionUU\
ID->"dbf31de4-b5cd-4686-8a2e-1d029c4455b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"u", "[", "\[Theta]_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    SubscriptBox["Ry", "3"], "[", "\[Theta]", "]"}], " ", 
   RowBox[{
    SubscriptBox["C", "3"], "[", 
    RowBox[{
     SubscriptBox["Rz", "2"], "[", "\[Theta]", "]"}], "]"}], " ", 
   RowBox[{
    SubscriptBox["Ry", "3"], "[", "\[Theta]", "]"}], " ", 
   SubscriptBox["H", "2"], " ", 
   SubscriptBox["X", "3"], " ", 
   SubscriptBox["T", "3"], " ", 
   RowBox[{
    SubscriptBox["C", "0"], "[", 
    SubscriptBox["X", "1"], "]"}]}]}]], "Input",ExpressionUUID->"eb2bbdca-\
c28c-43cd-bbe0-fd624403ceb2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"ListLinePlot", " ", "@", "  ", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"CalcFidelity", "[", 
      RowBox[{"\[Psi]", ",", " ", 
       RowBox[{"ApplyCircuit", "[", 
        RowBox[{
         RowBox[{"u", "[", "\[Theta]", "]"}], ",", "\[Psi]", ",", "\[Phi]"}], 
        "]"}]}], "]"}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", " ", "0", ",", " ", 
       RowBox[{"2", "\[Pi]"}], ",", " ", ".1"}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7554866301600313`*^9, 3.7554866976288643`*^9}, {
  3.755493930645673*^9, 3.755493987485917*^9}, {3.755506068522099*^9, 
  3.755506078738405*^9}, {3.75558935004182*^9, 
  3.755589373215231*^9}},ExpressionUUID->"c450f402-38a4-4462-a457-\
14c417c75dc2"],

Cell[BoxData[
 GraphicsBox[{{}, {}, {}, {}, {}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 1}, {0, 1}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.7555892216291113`*^9, 3.755589225934132*^9}, 
   3.755589324337708*^9, 
   3.755589355888859*^9},ExpressionUUID->"428d265f-ca15-409f-a5a1-\
c0992993f65a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ApplyCircuit", "[", 
  RowBox[{
   RowBox[{"u", "[", ".3", "]"}], ",", "\[Psi]", ",", "\[Phi]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7555894011795263`*^9, 
  3.7555894012555447`*^9}},ExpressionUUID->"5c19f5f0-0486-46b8-9b9b-\
1455dea2b159"],

Cell[BoxData[
 RowBox[{"QuEST`Private`ApplyCircuitInternal", "[", 
  RowBox[{"3", ",", 
   RowBox[{"{", 
    RowBox[{
    "X", ",", "T", ",", "X", ",", "H", ",", "Ry", ",", "Rz", ",", "Ry"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "1"}], ",", "3", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3", ",", "3", ",", "2", ",", "3", ",", "2", ",", "3"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0.3`", ",", "0.3`", ",", 
     "0.3`"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.7555893878313704`*^9, 
  3.755589401584258*^9}},ExpressionUUID->"3bd21243-ed14-4432-90a1-\
76e29e69a99d"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DestroyQureg", "[", "\[Psi]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DestroyQureg", "[", "\[Phi]", "]"}], ";"}]}], "Input",ExpressionUUI\
D->"0956a281-ae5f-4ccc-b174-ea24b8aa90bb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DestroyQuESTEnv", "[", "env", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.755589124913232*^9, 
  3.755589155654263*^9}},ExpressionUUID->"7fdc322e-8762-48fb-b4f0-\
24395c7a1330"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"QuEST`mytest", "::", "usage"}], "=", 
   "\"\<mytest[a] returns a\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QuEST`mytest", "[", "a_", "]"}], " ", ":=", " ", "a"}]}], "Input",
 CellChangeTimes->{{3.75558948438386*^9, 3.755589490456525*^9}, {
  3.755589531138402*^9, 
  3.7555895441135798`*^9}},ExpressionUUID->"3dd4519d-acea-4337-8ef9-\
0fdab63e6541"]
},
WindowSize->{808, 707},
WindowMargins->{{Automatic, -1012}, {-35, Automatic}},
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 256, 6, 30, "Input",ExpressionUUID->"85fd61b8-b777-4765-822e-c28cb3e65ef0"],
Cell[817, 28, 201, 4, 30, "Input",ExpressionUUID->"31e4471c-1aaf-492b-8916-245882351583"],
Cell[1021, 34, 273, 6, 30, "Input",ExpressionUUID->"950d8e49-2232-43fa-ae46-0b0e5703508e"],
Cell[1297, 42, 304, 7, 52, "Input",ExpressionUUID->"95520a55-bd31-491a-b6f4-f46aac7e5655"],
Cell[1604, 51, 238, 5, 52, "Input",ExpressionUUID->"dbf31de4-b5cd-4686-8a2e-1d029c4455b7"],
Cell[1845, 58, 610, 18, 32, "Input",ExpressionUUID->"eb2bbdca-c28c-43cd-bbe0-fd624403ceb2"],
Cell[CellGroupData[{
Cell[2480, 80, 870, 19, 115, "Input",ExpressionUUID->"c450f402-38a4-4462-a457-14c417c75dc2"],
Cell[3353, 101, 1147, 34, 246, "Output",ExpressionUUID->"428d265f-ca15-409f-a5a1-c0992993f65a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4537, 140, 271, 7, 30, "Input",ExpressionUUID->"5c19f5f0-0486-46b8-9b9b-1455dea2b159"],
Cell[4811, 149, 808, 23, 56, "Output",ExpressionUUID->"3bd21243-ed14-4432-90a1-76e29e69a99d"]
}, Open  ]],
Cell[5634, 175, 239, 6, 52, "Input",ExpressionUUID->"0956a281-ae5f-4ccc-b174-ea24b8aa90bb"],
Cell[5876, 183, 214, 5, 30, "Input",ExpressionUUID->"7fdc322e-8762-48fb-b4f0-24395c7a1330"],
Cell[6093, 190, 416, 10, 52, "Input",ExpressionUUID->"3dd4519d-acea-4337-8ef9-0fdab63e6541"]
}
]
*)

