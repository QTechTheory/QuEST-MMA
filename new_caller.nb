(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     25216,        656]
NotebookOptionsPosition[     23570,        623]
NotebookOutlinePosition[     23927,        639]
CellTagsIndexPosition[     23884,        636]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[StyleBox["Warning: more than 31 qubits may cause errors - MMA \
uses ints to store array lengths",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.753788059071817*^9, 
  3.753788085394414*^9}},ExpressionUUID->"5d45ac60-ee73-49d2-885c-\
5a7974dca956"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"disables", " ", "gate", " ", 
     RowBox[{"(", 
      RowBox[{"symbol", " ", "and", " ", "integer", " ", "suscript"}], ")"}], 
     " ", "commutivity"}], ",", " ", 
    RowBox[{"replaces", " ", "Times", " ", "with", " ", "Dot"}]}], " ", 
   "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"$Pre", " ", "=", " ", "\n", "  ", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "arg", "}"}], ",", " ", "\n", "   ", 
       RowBox[{"ReleaseHold", "[", "\n", "    ", 
        RowBox[{
         RowBox[{"Hold", "[", "arg", "]"}], " ", "//.", "  ", "\n", "     ", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{"\[Alpha]___", ",", " ", "\n", "       ", 
            RowBox[{"patt", " ", ":", " ", 
             RowBox[{"(", 
              RowBox[{"Longest", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["_Symbol", "_Integer"], "|", 
                  RowBox[{
                   SubscriptBox["_Symbol", "_Integer"], "[", "___", "]"}]}], 
                 ")"}], " ", ".."}], "]"}], ")"}]}], ",", " ", 
            "\[Omega]___"}], "]"}], " ", ":>", " ", "\n", "      ", 
          RowBox[{"Times", "[", 
           RowBox[{"\[Alpha]", ",", " ", 
            RowBox[{"Dot", "[", "patt", "]"}], ",", " ", "\[Omega]"}], 
           "]"}]}]}], "]"}], ",", " ", "HoldAll"}], "]"}]}], ";"}], "\n", 
   "\n", 
   RowBox[{"(*", " ", "opcodes", " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"getOpCode", "[", "gate_", "]"}], " ", ":=", "\n", "\t", 
    RowBox[{"gate", " ", "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"H", "\[Rule]", "0"}], ",", 
       RowBox[{"X", "\[Rule]", "1"}], ",", 
       RowBox[{"Y", "\[Rule]", "2"}], ",", 
       RowBox[{"Z", "\[Rule]", "3"}], ",", 
       RowBox[{"Rx", "\[Rule]", "4"}], ",", 
       RowBox[{"Ry", "\[Rule]", "5"}], ",", 
       RowBox[{"Rz", "\[Rule]", "6"}], ",", 
       RowBox[{"S", "\[Rule]", "7"}], ",", 
       RowBox[{"T", "\[Rule]", "8"}]}], "}"}]}]}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"recognising", " ", "gates"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"gatePatterns", " ", "=", " ", 
     RowBox[{"{", "\n", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["C", "ctrl_Integer"], "[", 
         RowBox[{
          SubscriptBox["gate_Symbol", "targ__Integer"], "[", "arg_", "]"}], 
         "]"}], " ", ":>", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"getOpCode", "[", "gate", "]"}], ",", " ", "ctrl", ",", " ",
           "targ", ",", " ", "arg"}], "}"}]}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{
         SubscriptBox["C", "ctrl_Integer"], "[", 
         SubscriptBox["gate_Symbol", "targ_Integer"], "]"}], " ", ":>", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"getOpCode", "[", "gate", "]"}], ",", " ", "ctrl", ",", " ",
           "targ", ",", " ", "0"}], "}"}]}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{
         SubscriptBox["gate_Symbol", "targ_Integer"], "[", "arg_", "]"}], " ",
         ":>", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"getOpCode", "[", "gate", "]"}], ",", " ", 
          RowBox[{"-", "1"}], ",", " ", "targ", ",", " ", "arg"}], "}"}]}], 
       ",", "\n", "\t", 
       RowBox[{
        SubscriptBox["gate_Symbol", "targ_Integer"], " ", ":>", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"getOpCode", "[", "gate", "]"}], ",", " ", 
          RowBox[{"-", "1"}], ",", " ", "targ", ",", " ", "0"}], "}"}]}]}], 
      "\n", "}"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "converting", " ", "gate", " ", "sequence", " ", "to", " ", "code", " ", 
     RowBox[{"lists", ":", " ", 
      RowBox[{"{", 
       RowBox[{
       "opcodes", ",", " ", "ctrls", ",", " ", "targs", ",", " ", "params"}], 
       "}"}]}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"codifyCircuit", "[", "circuit_Dot", "]"}], " ", ":=", "\n", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"circuit", " ", "/.", " ", 
       RowBox[{"Dot", " ", "\[Rule]", " ", "List"}]}], " ", "/.", " ", 
      "gatePatterns"}], " ", "//", " ", "Transpose"}]}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "applying", " ", "a", " ", "sequence", " ", "of", " ", "symoblic", " ", 
     "gates", " ", "to", " ", "a", " ", "qureg"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"ApplyCircuit", "[", 
     RowBox[{"circuit_Dot", ",", " ", "qureg_Integer"}], "]"}], " ", ":=", 
    "\n", "\t", 
    RowBox[{"With", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"codes", " ", "=", " ", 
        RowBox[{"codifyCircuit", "[", "circuit", "]"}]}], "}"}], ",", "\n", 
      "\t\t", 
      RowBox[{"ApplyCircuitInternal", "[", 
       RowBox[{"qureg", ",", " ", 
        RowBox[{"codes", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
        RowBox[{"codes", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
        RowBox[{"codes", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
        RowBox[{"codes", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], "\n", "\t", "]"}]}], "\n",
    "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "apply", " ", "a", " ", "circuit", " ", "to", " ", "get", " ", "an", " ", 
     "output", " ", "state", " ", "without", " ", "changing", " ", "input", 
     " ", "state"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"ApplyCircuit", "[", 
     RowBox[{
     "circuit_Dot", ",", " ", "inQureg_Integer", ",", " ", 
      "outQureg_Integer"}], "]"}], " ", ":=", "\n", "\t", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\n", "\t\t", 
      RowBox[{
       RowBox[{"CloneQureg", "[", 
        RowBox[{"outQureg", ",", " ", "inQureg"}], "]"}], ";", "\n", "\t\t", 
       RowBox[{"ApplyCircuit", "[", 
        RowBox[{"circuit", ",", " ", "outQureg"}], "]"}]}]}], "\n", "\t", 
     "]"}]}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"destroying", " ", "a", " ", "remote", " ", "qureg"}], ",", " ", 
     
     RowBox[{
     "and", " ", "clearing", " ", "the", " ", "local", " ", "symbol"}]}], " ",
     "*)"}], "\n", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"DestroyQureg", ",", " ", "HoldAll"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"DestroyQureg", "[", "qureg_Integer", "]"}], " ", ":=", "\n", 
    "\t", 
    RowBox[{"DestroyQuregInternal", "[", "qureg", "]"}]}], "\n", 
   RowBox[{
    RowBox[{"DestroyQureg", "[", "qureg_Symbol", "]"}], " ", ":=", "\n", "\t", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", " ", 
      RowBox[{
       RowBox[{"DestroyQuregInternal", "[", 
        RowBox[{"ReleaseHold", "@", "qureg"}], "]"}], ";", " ", 
       RowBox[{"Clear", "[", "qureg", "]"}]}]}], "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{"ToMatrix", "[", "qureg_Integer", "]"}], " ", ":=", "\n", "\t", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"data", " ", "=", " ", 
        RowBox[{"GetStateVecInternal", "[", "qureg", "]"}]}], "}"}], ",", 
      "\n", "\t\t", 
      RowBox[{"If", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"data", "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", "\[Equal]", " ", "0"}], ",", 
        "\n", "\t\t\t", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#1", " ", "+", " ", 
            RowBox[{"\[ImaginaryI]", " ", "#2"}]}], " ", "&"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"data", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
            RowBox[{"data", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}], ",", "\n", 
        "\t\t\t", 
        RowBox[{"Transpose", " ", "@", " ", 
         RowBox[{"ArrayReshape", "[", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#1", " ", "+", " ", 
               RowBox[{"\[ImaginaryI]", " ", "#2"}]}], " ", "&"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"data", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
               RowBox[{"data", "[", 
                RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}], ",", " ", 
           "\n", "\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{
             SuperscriptBox["2", 
              RowBox[{"data", "[", 
               RowBox[{"[", "1", "]"}], "]"}]], ",", 
             SuperscriptBox["2", 
              RowBox[{"data", "[", 
               RowBox[{"[", "1", "]"}], "]"}]]}], "}"}]}], "\n", "\t\t\t", 
          "]"}]}]}], "\n", "\t\t", "]"}]}], "\n", "\t", "]"}]}]}]}]], "Code",
 CellChangeTimes->CompressedData["
1:eJwdyVsoQ3EAx/HxYNiGkAeTwuJB0VbL5UWnRoqNJJHbrGgvosZcy60ty2oP
S9aEsuhQSsiLXEurJTy4NHNZWUZHh2xjIvn/zsO3z8M3Q9NV0x7J4/HSSZCt
uNkK3jKUlq0/gL8Blwv6GmvdUOxy54WI1/s+TrXseOKT+K71GGGkddcCN5cz
rbDFOURDQesL5+Pwrw92PKj83NdZBGEibVPFwXwZHRbeMdTO9sgPlEQH8kTE
c/tPEZSz3SWw+DvI2XPhsDKvDMX3iuyQpzPzT78Yyp5zkgzr9a5UqGpbTYOs
VpoFKycLSuBVgaEcanpNnIlrqmooaVc0weKUKjV8+jjTwLqEUDAmzFCZtvkw
jHrrG4slLs7qjVAzYJ2CzYP+aWgbcrhhp6j6Hv4tNJQKiN7xfk7TUUSukJh0
6ZZDZcOzIZ5YqJcaIR00zcCQ38tZV6acg8p1/hJk+wM0lGY3rcDsQ/EGPNsb
PYbxZucNVBgjPPAfcO8XzQ==
  
  "],ExpressionUUID->"67ad40e4-903b-439c-9232-44ed66fb26eb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", " ", "@", " ", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.753697601794017*^9, 3.753697611953724*^9}, 
   3.753697670943144*^9, {3.753899170718107*^9, 3.753899171641039*^9}, {
   3.7539014087247143`*^9, 3.753901409634951*^9}, 
   3.753903177602127*^9},ExpressionUUID->"a0dc9828-87df-4557-83d2-\
609d7b730ed8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Install", "[", "\"\<quest_link\>\"", "]"}], " ", "//", " ", 
   "LinkPatterns"}], " ", "//", " ", "TableForm"}]], "Input",
 CellChangeTimes->{{3.753922389409726*^9, 
  3.75392239342696*^9}},ExpressionUUID->"8eebb608-31f6-45c9-b88d-\
95106b01adc2"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      TagBox[
       RowBox[{"CreateQureg", "[", "numQubits_Integer", "]"}],
       HoldForm]},
     {
      TagBox[
       RowBox[{"CreateDensityQureg", "[", "numQubits_Integer", "]"}],
       HoldForm]},
     {
      TagBox[
       RowBox[{"DestroyQuregInternal", "[", "id_Integer", "]"}],
       HoldForm]},
     {
      TagBox[
       RowBox[{"InitZeroState", "[", "qureg_Integer", "]"}],
       HoldForm]},
     {
      TagBox[
       RowBox[{"InitPlusState", "[", "qureg_Integer", "]"}],
       HoldForm]},
     {
      TagBox[
       RowBox[{"InitClassicalState", "[", 
        RowBox[{"qureg_Integer", ",", "state_Integer"}], "]"}],
       HoldForm]},
     {
      TagBox[
       RowBox[{"InitPureState", "[", 
        RowBox[{"targetQureg_Integer", ",", "pureQureg_Integer"}], "]"}],
       HoldForm]},
     {
      TagBox[
       RowBox[{"CloneQureg", "[", 
        RowBox[{"target_Integer", ",", "source_Integer"}], "]"}],
       HoldForm]},
     {
      TagBox[
       RowBox[{"ApplyOneQubitDepolariseError", "[", 
        RowBox[{"qureg_Integer", ",", "qb_Integer", ",", "prob_Real"}], "]"}],
       
       HoldForm]},
     {
      TagBox[
       RowBox[{"ApplyTwoQubitDepolariseError", "[", 
        RowBox[{
        "qureg_Integer", ",", "qb1_Integer", ",", "qb2_Integer", ",", 
         "prob_Real"}], "]"}],
       HoldForm]},
     {
      TagBox[
       RowBox[{"ApplyOneQubitDephaseError", "[", 
        RowBox[{"qureg_Integer", ",", "qb_Integer", ",", "prob_Real"}], "]"}],
       
       HoldForm]},
     {
      TagBox[
       RowBox[{"ApplyTwoQubitDephaseError", "[", 
        RowBox[{
        "qureg_Integer", ",", "qb1_Integer", ",", "qb2_Integer", ",", 
         "prob_Real"}], "]"}],
       HoldForm]},
     {
      TagBox[
       RowBox[{"CalcProbOfOutcome", "[", 
        RowBox[{"qureg_Integer", ",", "qb_Integer", ",", "outcome_Integer"}], 
        "]"}],
       HoldForm]},
     {
      TagBox[
       RowBox[{"CalcFidelity", "[", 
        RowBox[{"qureg1_Integer", ",", "qureg2_Integer"}], "]"}],
       HoldForm]},
     {
      TagBox[
       RowBox[{"ApplyCircuitInternal", "[", 
        RowBox[{
        "qureg_Integer", ",", "opcodes_List", ",", "ctrls_List", ",", 
         "targs_List", ",", "params_List"}], "]"}],
       HoldForm]},
     {
      TagBox[
       RowBox[{"GetStateVecInternal", "[", "qureg_Integer", "]"}],
       HoldForm]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.753922393779825*^9, 3.7539225301728687`*^9, 3.753922830126114*^9, {
   3.753923097172703*^9, 3.7539231115926857`*^9}, 3.753923283333209*^9, {
   3.75392378667553*^9, 3.753923809901183*^9}, 3.753926219611042*^9, 
   3.753926278521656*^9, 3.753926329071796*^9, 3.753926366495524*^9, 
   3.753926933864216*^9, 3.753933997999976*^9, 3.753934051546254*^9, 
   3.753934388865016*^9, 
   3.7539345556417933`*^9},ExpressionUUID->"7fc87e77-c496-4bf1-976d-\
4d24d0442330"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7539343993956347`*^9, 3.753934411109336*^9}, 
   3.753934504083331*^9, {3.753934572067502*^9, 
   3.7539346530870523`*^9}},ExpressionUUID->"ab70b4be-4192-4456-be44-\
62f2d0b4442a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"a", " ", "=", " ", 
   RowBox[{"CreateDensityQureg", " ", "@", " ", "2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InitPlusState", "[", "a", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToMatrix", " ", "@", " ", "a"}], " ", "//", " ", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DestroyQureg", " ", "@", " ", "a"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7539344143700247`*^9, 3.753934416264531*^9}, {
  3.753934605764668*^9, 
  3.7539346702121143`*^9}},ExpressionUUID->"7b805440-8eba-4579-8c24-\
21c6b58b8286"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.753934416571197*^9, 3.753934470746698*^9}, {
  3.753934574566298*^9, 
  3.753934670486699*^9}},ExpressionUUID->"10bf8a8e-63bb-44da-b204-\
29ec23f4c7c4"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Psi]", " ", "=", " ", 
   RowBox[{"CreateQureg", "[", "20", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]", " ", "=", " ", 
   RowBox[{"CreateQureg", "[", "20", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.753922520113247*^9, 3.753922558129609*^9}, 
   3.753923119077773*^9, {3.753923322786378*^9, 3.753923324158163*^9}, {
   3.753923813069538*^9, 3.7539238409114637`*^9}, {3.753923907836006*^9, 
   3.753923917253601*^9}, {3.753924730640173*^9, 3.753924731807184*^9}, {
   3.753924787955001*^9, 3.7539247907594557`*^9}, {3.753924909814905*^9, 
   3.753924911460745*^9}},ExpressionUUID->"41bb611e-1eba-4e99-ad67-\
142add116079"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"InitPlusState", "[", "\[Psi]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InitPlusState", "[", "\[Phi]", "]"}], ";"}]}], "Input",ExpressionUU\
ID->"876ed2bf-ccc1-4ebd-83c7-630ee83f91e4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"u", "[", "\[Theta]_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{
     SubscriptBox["Ry", "3"], "[", "\[Theta]", "]"}], " ", 
    RowBox[{
     SubscriptBox["C", "3"], "[", 
     RowBox[{
      SubscriptBox["Rz", "2"], "[", "\[Theta]", "]"}], "]"}], " ", 
    RowBox[{
     SubscriptBox["Ry", "3"], "[", "\[Theta]", "]"}]}]}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", " ", "@", "  ", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"CalcFidelity", "[", 
     RowBox[{"\[Psi]", ",", " ", 
      RowBox[{"ApplyCircuit", "[", 
       RowBox[{
        RowBox[{"u", "[", "\[Theta]", "]"}], ",", "\[Psi]", ",", "\[Phi]"}], 
       "]"}]}], "]"}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", " ", "0", ",", " ", 
      RowBox[{"2", "\[Pi]"}], ",", " ", ".1"}], "}"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.753922568401556*^9, 3.753922595009801*^9}, {
  3.75392262708187*^9, 3.753922641295259*^9}, {3.7539232891949368`*^9, 
  3.753923310810355*^9}, {3.753923795176051*^9, 3.753923886323962*^9}, {
  3.753923942729895*^9, 3.753923947580055*^9}, {3.753923987221167*^9, 
  3.753924018459556*^9}, {3.753924097260865*^9, 3.753924129016276*^9}, {
  3.753924675415457*^9, 3.753924718420732*^9}, {3.7539247566333237`*^9, 
  3.753924757346541*^9}, {3.753924980703535*^9, 3.7539249852639637`*^9}, {
  3.7539271115041113`*^9, 
  3.7539271404080057`*^9}},ExpressionUUID->"93d682c6-f4a1-4644-bd02-\
873476592b2c"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.016666666666666666`],
      AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxV0H8s1HEcx/HLGiKFmh/9WBSSmfxKfsULd47DHXYTK3ZTEnJ+pGxputka
zbKVmeNKkYjWMkwXdk0uFpffbMaQLEKHrkXmRzXv+6Pv9tlnjz0/38937695
bEp4nAaDwfD+u/7tO8+y9/87A88FYr5r5RJZG8bxxnfji5RkfYwhwXdsapF8
ENmXysUTknmyCSw1dFYzp2fJR3B0bm+VfHiGbIZ1ByuWXuln8nEkdVaXXKkZ
J1vAgPUiyok/QraCw0aGlJ/ZR7ZG4wg/QiDuINtgQq/LvGm7hWyLqfECwUL+
K7IdqrnhWxPaxWR7XJR3lCqbhWQHfLsnaMs6zCQ7YrssVjiYlEt2QtiPdzOa
gnKyMxxjyvu+t9SRz+BNaGpqY1Az2QWKLbHyPuc9+SzSpXNx7YmdZFd0XGM+
zbRTkN2Qy+HnSy3V87lDwdUx9pX3kz3wqbdfIpscIHuCEW3/bEg4SD4H0aEK
97w0tb0wH3SSzVpWn/fG5pOltIx19X3A5u8cN1klfU8ErE6P32bt66HuA+H+
omLTm13UfZCcNWyv1aD+377QOl2X5aii+US+cMuJ1KxvlVH3w1TBLVN7ayl1
P5ToPgphRNRTZ2LZ7kBPa1stdSZ44YXuyZUV1FmI9GiITnggps7CBf0RU13b
Aur+sDNcOLY8KqLuD16jcrRJkEqdjRSTseC2U1HU2ej4peqWqFyoB6BlcqiG
n67w2ukBkMukLrtCzKkH4jJP6KMy8qL3A9Gw1F42ps+hzkFwbs5g/ddQ6hzE
VGabGSWGUw9Ct+SD7XpVGPUgbI0vvd4Tw6UejBvCWZFBIZt6MDaZhQO7r4N6
CAx/SgRXzztTD8HDt61f1l5aUudiRTt5cX3SkDoXaXcsvD2d13bmYfBQW2TD
W+ntp/l42FB+PPF4Mc/rD4PjI9Q=
      "]]}}, {}, {}, {}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 63.}, {0, 1.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.753923992937928*^9, 3.753924023343444*^9}, {
   3.7539241026857452`*^9, 3.753924131383918*^9}, {3.75392468203161*^9, 
   3.753924722129106*^9}, {3.75392489918237*^9, 3.7539249433474703`*^9}, {
   3.753924981278163*^9, 3.753924987236793*^9}, 3.7539250219084063`*^9, {
   3.753927129318803*^9, 
   3.7539271427193213`*^9}},ExpressionUUID->"d302f071-684b-4ab1-b735-\
ed4f66aa314e"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DestroyQureg", "[", "\[Psi]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DestroyQureg", "[", "\[Phi]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.753922542194704*^9, 3.753922548109623*^9}, {
  3.7539226496038933`*^9, 3.7539226569122257`*^9}, {3.7539228374828453`*^9, 
  3.753922839991508*^9}, {3.753923101120936*^9, 3.7539231029235086`*^9}, {
  3.7539233194311543`*^9, 3.753923319546789*^9}, {3.753923845053629*^9, 
  3.7539238602620983`*^9}, {3.753923920528656*^9, 
  3.7539239270890007`*^9}},ExpressionUUID->"7e4ed74a-4ee8-44a2-82b4-\
de8cd3dc1394"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Uninstall", "[", "\"\<quest_link\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.75392239441737*^9, 3.753922428738454*^9}, {
  3.753925134940875*^9, 
  3.753925139112884*^9}},ExpressionUUID->"bf4b9f2a-dd12-4a5b-b41f-\
e0741c248e47"]
},
WindowSize->{808, 707},
WindowMargins->{{4, Automatic}, {Automatic, 4}},
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 269, 5, 35, "Text",ExpressionUUID->"5d45ac60-ee73-49d2-885c-5a7974dca956"],
Cell[830, 27, 9470, 236, 1203, "Code",ExpressionUUID->"67ad40e4-903b-439c-9232-44ed66fb26eb"],
Cell[10303, 265, 401, 8, 30, "Input",ExpressionUUID->"a0dc9828-87df-4557-83d2-609d7b730ed8"],
Cell[CellGroupData[{
Cell[10729, 277, 294, 7, 30, "Input",ExpressionUUID->"8eebb608-31f6-45c9-b88d-95106b01adc2"],
Cell[11026, 286, 3410, 108, 314, "Output",ExpressionUUID->"7fc87e77-c496-4bf1-976d-4d24d0442330"]
}, Open  ]],
Cell[14451, 397, 229, 4, 30, "Input",ExpressionUUID->"ab70b4be-4192-4456-be44-62f2d0b4442a"],
Cell[CellGroupData[{
Cell[14705, 405, 599, 15, 94, "Input",ExpressionUUID->"7b805440-8eba-4579-8c24-21c6b58b8286"],
Cell[15307, 422, 2322, 55, 94, "Output",ExpressionUUID->"10bf8a8e-63bb-44da-b204-29ec23f4c7c4"]
}, Open  ]],
Cell[17644, 480, 692, 13, 52, "Input",ExpressionUUID->"41bb611e-1eba-4e99-ad67-142add116079"],
Cell[18339, 495, 238, 5, 52, "Input",ExpressionUUID->"876ed2bf-ccc1-4ebd-83c7-630ee83f91e4"],
Cell[CellGroupData[{
Cell[18602, 504, 1589, 36, 136, "Input",ExpressionUUID->"93d682c6-f4a1-4644-bd02-873476592b2c"],
Cell[20194, 542, 2473, 56, 246, "Output",ExpressionUUID->"d302f071-684b-4ab1-b735-ed4f66aa314e"]
}, Open  ]],
Cell[22682, 601, 610, 12, 52, "Input",ExpressionUUID->"7e4ed74a-4ee8-44a2-82b4-de8cd3dc1394"],
Cell[23295, 615, 271, 6, 30, "Input",ExpressionUUID->"bf4b9f2a-dd12-4a5b-b41f-e0741c248e47"]
}
]
*)

